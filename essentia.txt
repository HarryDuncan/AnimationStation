ENV FORCE_UNSAFE_CONFIGURE=1
RUN git clone https://github.com/Homebrew/brew ~/.linuxbrew/Homebrew \
&& mkdir ~/.linuxbrew/bin \
&& ln -s ../Homebrew/bin/brew ~/.linuxbrew/bin \
&& eval $(~/.linuxbrew/bin/brew shellenv) \
&& brew --version \
&& brew upgrade \
&& brew install gcc --force-bottle \
&& brew install pkg-config readline sqlite gdbm freetype \
&& brew install libpng eigen libyaml fftw libsamplerate libtag

# Download and install essentia

WORKDIR /analyzer
RUN git clone https://github.com/MTG/essentia.git
WORKDIR /analyzer/essentia
RUN git checkout v2.1_beta5


RUN python3 ./waf configure --build-static --with-python --with-cpptests --with-examples --with-vamp
RUN python3 ./waf
RUN python3 ./waf install
